{"version":3,"file":"ChangePasswordPage.1ebdc265fc3bd7452fcd.js","sources":["webpack:////./public/app/core/components/ForgottenPassword/ChangePasswordPage.tsx","webpack:////./public/app/features/profile/ChangePasswordForm.tsx","webpack:////./public/app/features/profile/ChangePasswordPage.tsx"],"sourcesContent":["import React, { FC } from 'react';\nimport { LoginLayout, InnerBox } from '../Login/LoginLayout';\nimport { ChangePassword } from './ChangePassword';\nimport LoginCtrl from '../Login/LoginCtrl';\n\nexport const ChangePasswordPage: FC = () => {\n  return (\n    <LoginLayout>\n      <InnerBox>\n        <LoginCtrl>{({ changePassword }) => <ChangePassword onSubmit={changePassword} />}</LoginCtrl>\n      </InnerBox>\n    </LoginLayout>\n  );\n};\n\nexport default ChangePasswordPage;\n","import React, { FC } from 'react';\nimport config from 'app/core/config';\nimport { Button, LinkButton, Form, Field, Input, HorizontalGroup } from '@grafana/ui';\nimport { ChangePasswordFields } from 'app/core/utils/UserProvider';\nimport { css } from 'emotion';\n\nexport interface Props {\n  isSaving: boolean;\n  onChangePassword: (payload: ChangePasswordFields) => void;\n}\n\nexport const ChangePasswordForm: FC<Props> = ({ onChangePassword, isSaving }) => {\n  const { ldapEnabled, authProxyEnabled } = config;\n\n  if (ldapEnabled || authProxyEnabled) {\n    return <p>启用ldap或auth代理身份验证时，无法更改密码。</p>;\n  }\n  return (\n    <div\n      className={css`\n        max-width: 400px;\n      `}\n    >\n      <Form onSubmit={onChangePassword}>\n        {({ register, errors, getValues }) => {\n          return (\n            <>\n              <Field label=\"旧密码\" invalid={!!errors.oldPassword} error={errors?.oldPassword?.message}>\n                <Input type=\"password\" name=\"oldPassword\" ref={register({ required: '旧密码必填项' })} />\n              </Field>\n\n              <Field label=\"新密码\" invalid={!!errors.newPassword} error={errors?.newPassword?.message}>\n                <Input\n                  type=\"password\"\n                  name=\"newPassword\"\n                  ref={register({\n                    required: '新密码必填项',\n                    validate: {\n                      confirm: v => v === getValues().confirmNew || '密码必须匹配',\n                      old: v => v !== getValues().oldPassword || `新密码不能与旧密码相同。`,\n                    },\n                  })}\n                />\n              </Field>\n\n              <Field label=\"确认密码\" invalid={!!errors.confirmNew} error={errors?.confirmNew?.message}>\n                <Input\n                  type=\"password\"\n                  name=\"confirmNew\"\n                  ref={register({\n                    required: '需要新的密码确认',\n                    validate: v => v === getValues().newPassword || '密码必须匹配',\n                  })}\n                />\n              </Field>\n              <HorizontalGroup>\n                <Button variant=\"primary\" disabled={isSaving}>\n                  更改密码\n                </Button>\n                <LinkButton variant=\"secondary\" href={`${config.appSubUrl}/profile`}>\n                  取消\n                </LinkButton>\n              </HorizontalGroup>\n            </>\n          );\n        }}\n      </Form>\n    </div>\n  );\n};\n","import React, { PureComponent } from 'react';\nimport { hot } from 'react-hot-loader';\nimport { connect } from 'react-redux';\nimport { StoreState } from 'app/types';\nimport { NavModel } from '@grafana/data';\nimport { getNavModel } from 'app/core/selectors/navModel';\nimport { UserProvider } from 'app/core/utils/UserProvider';\nimport Page from 'app/core/components/Page/Page';\nimport { ChangePasswordForm } from './ChangePasswordForm';\n\nexport interface Props {\n  navModel: NavModel;\n}\n\nexport class ChangePasswordPage extends PureComponent<Props> {\n  render() {\n    const { navModel } = this.props;\n    return (\n      <Page navModel={navModel}>\n        <UserProvider>\n          {({ changePassword }, states) => (\n            <Page.Contents>\n              <h3 className=\"page-sub-heading\">更改你的密码</h3>\n              <ChangePasswordForm onChangePassword={changePassword} isSaving={states.changePassword} />\n            </Page.Contents>\n          )}\n        </UserProvider>\n      </Page>\n    );\n  }\n}\n\nfunction mapStateToProps(state: StoreState) {\n  return {\n    navModel: getNavModel(state.navIndex, `change-password`),\n  };\n}\n\nconst mapDispatchToProps = {};\n\nexport default hot(module)(connect(mapStateToProps, mapDispatchToProps)(ChangePasswordPage));\n"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AAGA;AAAA;AAAA;AAAA;AAAA;AAIA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACfA;AACA;AACA;AAEA;AAOA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AAAA;AAEA;AADA;AAKA;AAAA;AACA;AACA;AADA;AAAA;AAAA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAFA;AAFA;AAHA;AAaA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAFA;AAHA;AAUA;AAAA;AAAA;AAGA;AAAA;AAAA;AAMA;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrEA;AACA;AACA;AAGA;AACA;AACA;AACA;AAMA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AAEA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAHA;AASA;AAfA;AACA;AADA;AAAA;AACA;AAiBA;AACA;AACA;AADA;AAGA;AACA;AACA;AAEA;;;;;A","sourceRoot":""}