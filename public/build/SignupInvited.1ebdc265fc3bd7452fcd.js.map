{"version":3,"file":"SignupInvited.1ebdc265fc3bd7452fcd.js","sources":["webpack:////./public/app/features/users/SignupInvited.tsx"],"sourcesContent":["import React, { FC, useState } from 'react';\nimport { hot } from 'react-hot-loader';\nimport { connect, MapDispatchToProps, MapStateToProps } from 'react-redux';\nimport { StoreState } from 'app/types';\nimport { updateLocation } from 'app/core/actions';\nimport { getBackendSrv } from '@grafana/runtime';\nimport { Button, Field, Form, Input } from '@grafana/ui';\nimport { useAsync } from 'react-use';\nimport Page from 'app/core/components/Page/Page';\nimport { contextSrv } from 'app/core/core';\nimport { getConfig } from 'app/core/config';\nimport { UrlQueryValue } from '@grafana/data';\n\ninterface ConnectedProps {\n  code?: UrlQueryValue;\n}\n\ninterface DispatchProps {\n  updateLocation: typeof updateLocation;\n}\n\ninterface FormModel {\n  email: string;\n  name?: string;\n  username: string;\n  password?: string;\n}\n\nconst navModel = {\n  main: {\n    icon: 'grafana',\n    text: 'Invite',\n    subTitle: '注册您的Grafana帐户',\n    breadcrumbs: [{ title: 'Login', url: 'login' }],\n  },\n  node: {\n    text: '',\n  },\n};\n\nconst SingupInvitedPageUnconnected: FC<DispatchProps & ConnectedProps> = ({ code }) => {\n  const [initFormModel, setInitFormModel] = useState<FormModel>();\n  const [greeting, setGreeting] = useState<string>();\n  const [invitedBy, setInvitedBy] = useState<string>();\n  useAsync(async () => {\n    const invite = await getBackendSrv().get('/api/user/invite/' + code);\n    setInitFormModel({\n      email: invite.email,\n      name: invite.name,\n      username: invite.email,\n    });\n\n    setGreeting(invite.name || invite.email || invite.username);\n    setInvitedBy(invite.invitedBy);\n  }, []);\n\n  const onSubmit = async (formData: FormModel) => {\n    await getBackendSrv().post('/api/user/invite/complete', { ...formData, inviteCode: code });\n    window.location.href = getConfig().appSubUrl + '/';\n  };\n\n  return (\n    <Page navModel={navModel}>\n      <Page.Contents>\n        <h3 className=\"page-sub-heading\">Hello {greeting || 'there'}.</h3>\n\n        <div className=\"modal-tagline p-b-2\">\n          <em>{invitedBy || 'Someone'}</em> 邀请你加入Grafana和组织{' '}\n          <span className=\"highlight-word\">{contextSrv.user.orgName}</span>\n          <br />\n          请完成以下操作并选择密码以接受邀请并继续：\n        </div>\n        <Form defaultValues={initFormModel} onSubmit={onSubmit}>\n          {({ register, errors }) => (\n            <>\n              <Field invalid={!!errors.email} error={errors.email && errors.email.message} label=\"电子邮件\">\n                <Input\n                  placeholder=\"email@example.com\"\n                  name=\"email\"\n                  ref={register({\n                    required: '电子邮件为必填项',\n                    pattern: {\n                      value: /^\\S+@\\S+$/,\n                      message: '电子邮件无效',\n                    },\n                  })}\n                />\n              </Field>\n              <Field invalid={!!errors.name} error={errors.name && errors.name.message} label=\"名字\">\n                <Input placeholder=\"名字（可选）\" name=\"name\" ref={register} />\n              </Field>\n              <Field invalid={!!errors.username} error={errors.username && errors.username.message} label=\"用户名\">\n                <Input placeholder=\"Username\" name=\"username\" ref={register({ required: '用户名必填项' })} />\n              </Field>\n              <Field invalid={!!errors.password} error={errors.password && errors.password.message} label=\"密码\">\n                <Input type=\"password\" placeholder=\"密码\" name=\"password\" ref={register({ required: '密码必填项' })} />\n              </Field>\n\n              <Button type=\"submit\">注册</Button>\n            </>\n          )}\n        </Form>\n      </Page.Contents>\n    </Page>\n  );\n};\n\nconst mapStateToProps: MapStateToProps<ConnectedProps, {}, StoreState> = (state: StoreState) => ({\n  code: state.location.routeParams.code,\n});\n\nconst mapDispatchToProps: MapDispatchToProps<DispatchProps, {}> = {\n  updateLocation,\n};\n\nexport default hot(module)(connect(mapStateToProps, mapDispatchToProps)(SingupInvitedPageUnconnected));\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAkBA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAJA;AAMA;AACA;AADA;AAPA;AACA;AAWA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AAHA;AAMA;AACA;AACA;AAVA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAWA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAFA;AAEA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAIA;AACA;AAAA;AAEA;AAAA;AAEA;AAAA;AAEA;AAAA;AAIA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAFA;AAHA;AAYA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAzBA;AAgCA;AACA;AACA;AAAA;AACA;AADA;AAAA;AACA;AAGA;AACA;AADA;AAIA;;;;;A","sourceRoot":""}